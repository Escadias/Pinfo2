# Contient les instructions pour lancer la configuration docker pour la webapp.

version: "3"

services:
    proxy:
        build: "nginx-pinfo2"
        image: "nginx-pinfo2"
        ports:
            - "80:80"
        volumes:
            - "../frontend/srvdist/:/usr/share/nginx/srvdist/"
        depends_on:
            - "appserver"
        restart: always
        networks:
            - masterproxy
            - default

    appserver:
        build: "wildfly-pinfo2"
        image: "wildfly-pinfo2"
        expose:
            - "8080"
        depends_on:
            - "database"
        volumes:
            - "../labCon/srvdeploy/:/opt/newwarstash/"
        restart: always
        networks:
            - default

    database:
        build: "mariadb-pinfo2"
        image: "mariadb-pinfo2"
        environment:
            MYSQL_ROOT_PASSWORD: "admin"
            MYSQL_DATABASE: "meskyne"
        expose:
            - "3306"
        restart: always
        networks:
            - default

networks:
    masterproxy:
        external: true
